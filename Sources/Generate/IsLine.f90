!======================================================================!
  integer function IsLine(n1, n2, b) 
!----------------------------------------------------------------------!
!   Checks if the line defined n1 and n2 is inside the block b.        !
!----------------------------------------------------------------------!
!------------------------------[Modules]-------------------------------!
  use all_mod
  use gen_mod
!----------------------------------------------------------------------! 
  implicit none
!-----------------------------[Parameters]-----------------------------!
  integer :: b, n1, n2
!-------------------------------[Locals]-------------------------------!
  integer :: l1, l2
!======================================================================!

  do l1=1,8
    do l2=1,8
      if( (block_points(b,l1) == n1) .and.                                &
          (block_points(b,l2) == n2) ) then
           goto 1
      end if 
    end do
  end do     

  IsLine=0
  return

1 IsLine=b
  return

  end function IsLine
