!======================================================================!
  subroutine IGlSumArray(phi, n) 
!----------------------------------------------------------------------!
!   Estimates global summ among all processors.                        !
!----------------------------------------------------------------------!
  implicit none
!------------------------------[Include]-------------------------------!
  include 'mpif.h'
!-----------------------------[Arguments]------------------------------!
  integer :: phi(1:n)
  integer :: n
!-------------------------------[Locals]-------------------------------!
  integer :: phi_new(1:n)
  integer :: error
!======================================================================!

!================================================
      call MPI_ALLREDUCE      &               
!-----------------------------------+------------
             (phi,            & ! send buffer
              phi_new,        & ! recv buffer 
              n,              & ! length     
              MPI_INTEGER8,   & ! datatype  
              MPI_SUM,        & ! operation 
              MPI_COMM_WORLD, &             
              error) 
!================================================

  phi = phi_new

  end subroutine
