!======================================================================!
  subroutine StaPar
!----------------------------------------------------------------------!
!   Initializes parallel execution.                                    !
!----------------------------------------------------------------------!
!------------------------------[Modules]-------------------------------!
  use par_mod 
!----------------------------------------------------------------------!
  implicit none
!------------------------------[Include]-------------------------------!
  include 'mpif.h'
!-------------------------------[Locals]-------------------------------!
  integer :: error
!======================================================================!

  CALL MPI_INIT(ERROR)

  CALL MPI_COMM_SIZE(MPI_COMM_WORLD,                                &
                     NPro,                                          &
                     error) 

  CALL MPI_COMM_RANK(MPI_COMM_WORLD,                                &
                     this,                                          &
                     error)

  this=this+1

  if(Npro == 1) then
    Npro = 0
    this = 0
  endif

  end subroutine StaPar
